/**
 * jQuery Billboard v1.2
 *
 * Terms of Use - jQuery Billboard
 * under the MIT (http://www.opensource.org/licenses/mit-license.php) License.
 *
 * Copyright 2010-2013 Steve Palmer All rights reserved.
 * (https://github.com/spalmer/Billboard)
 *
 */
 
(function(e){e.fn.billboard=function(t,n){var r=e(this);if(!r.length){return}if(r.data("billboard")){if(typeof t=="string"&&typeof r.data("billboard")[t]=="function"){r.data("billboard")[t].apply(this,n)}return r.data("billboard")}r.addClass("billboard").data("billboard",this);var i={easing:"easeInOutExpo",speed:1e3,duration:5e3,autoplay:true,loop:true,transition:"left",navType:"list",styleNav:true,includeFooter:true,autosize:true,resize:false,stretch:true,onSlideChange:function(){},onClickDotNav:function(){},onClickNext:function(){},onClickPrev:function(){},onClickPause:function(){},onClickPlay:function(){},onInit:function(){},onStart:function(){}};var s=this;s.settings={};var o=e("> ul > li",r),u=o.length,a=0,f=true,l=0,c=0,h=0,p=false,d=false,v=0,m=0,g=0,y=0,b,w=200;var E=e('<footer class="billboard-footer"></footer>'),S=e('<p class="billboard-caption"></p>'),x=e('<nav class="list"></nav>'),T=e('<nav class="controls"></nav>'),N=e('<div class="aspect-ratio" />');var C=e('<a href="#" class="control next" title="Next">Next</a>'),k=e('<a href="#" class="control prev" title="Previous">Previous</a>'),L=e('<a href="#" class="control play pause" title="Pause">Pause</a>');var A=function(){s.settings=e.extend({},i,t);if(u<=1){r.addClass("billboard-activated billboard-single");_();return}o.css("visibility","hidden");r.on("slideLoaded",function(e,t){a++;if(a==u){r.trigger("allSlidesLoaded")}}).on("allSlidesLoaded",function(){var t=e("> ul > li:first",r);if(!s.settings.resize){N.css({paddingTop:1/o.eq(l).data("aspectRatio")*100+"%"})}O()}).on("swipeleft",function(){if(s.settings.transition=="left")F();if(s.settings.transition=="right")I()}).on("swiperight",function(){if(s.settings.transition=="left")I();if(s.settings.transition=="right")F()}).on("swipeup",function(){if(s.settings.transition=="up")F();if(s.settings.transition=="down")I()}).on("swipedown",function(){if(s.settings.transition=="up")I();if(s.settings.transition=="down")F()});M();s.settings.onInit.apply(r,arguments)};s.play=function(){V()};s.pause=function(){U()};s.resume=function(){z()};s.goto=function(e){q(e)};s.get=function(e){return R(e)};s.sleep=function(){W()};s.wake=function(){X()};var O=function(){s.ready=true;r.addClass("billboard-activated").addClass(s.settings.autosize?"billboard-autosize":"billboard-fixedsize").addClass(s.settings.stretch?"billboard-stretch":"");if(s.settings.includeFooter){E.appendTo(r);S.appendTo(E);switch(s.settings.navType){case"controls":H();break;case"list":B();break;case"both":H();B();break;case"none":break}}setTimeout(function(){o.css("visibility","visible");V()},w);s.settings.onStart.apply(r,arguments)};var M=function(){var t=e("> ul > li:first",r);if(s.settings.styleNav){e(x).addClass("billboard-styled");e(T).addClass("billboard-styled")}_();switch(s.settings.transition){case"left":t.css("left","100%");break;case"right":t.css("left","-100%");break;case"up":t.css("top","-100%");break;case"down":t.css("top","100%");break}N.appendTo(r);L.click(function(e){e.preventDefault();U()});C.click(function(e){e.preventDefault();j();F();s.settings.onClickPrev.apply(r,[l,c,arguments])});k.click(function(e){e.preventDefault();j();I();s.settings.onClickNext.apply(r,[l,c,arguments])})};var _=function(){o.each(function(){D(e(this))})};var D=function(t){var n=e("img",t),r=n.length;t.data("imagesLoaded",0);if(r>0){n.one("load",function(){t.data("imagesLoaded",t.data("imagesLoaded")+1);if(t.data("imagesLoaded")==r){P(t)}}).each(function(){if(this.complete){e(this).load()}})}else{P(t)}};var P=function(t){var n,i;n=t.clone();n.appendTo("body").css({visibility:"hidden",position:"absolute"}).each(function(){i=e(this).width()/e(this).height()}).remove();t.data("aspectRatio",i).data("slideWidth",t.outerWidth()).data("slideHeight",t.outerHeight());r.trigger("slideLoaded",[t])};var H=function(){T.appendTo(E).append(k).append(L).append(C)};var B=function(){x.appendTo(E);var t,n;e("> ul > li",r).each(function(i){n=e(this).attr("title")!=""?' <span class="title">'+e(this).attr("title")+"</span>":"";t=e('<a href="#" class="dot" rel="'+i+'"><span class="index">'+(i+1)+"</span>"+n+"</a>");t.click(function(t){t.preventDefault();c=l;l=parseInt(e(this).attr("rel"));if(c==l){return}j();V();s.settings.onClickDotNav.apply(r,[l,c,arguments])}).appendTo(x)})};var j=function(){if(s.settings.autoplay&&!p){clearInterval(h);h=setInterval(F,s.settings.duration)}};var F=function(){if(s.settings.navType!="list"){d=false}c=l;l==u-1?l=0:l++;if(s.settings.autoplay&&l==0&&!s.settings.loop){clearInterval(h);return}V()};var I=function(){if(s.settings.navType!="list"){d=true}c=l;l==0?l=u-1:l--;V()};var q=function(e){j();if(e>=0&&e<u&&e!=l){if(s.settings.navType!="list"){d=e<l}c=l;l=e;V()}};var R=function(t){t+=1;if(t>u)return;var n=e("> ul > li:nth-child("+t+") > img",r).length?e("> ul > li:nth-child("+t+") > img",r):e("> ul > li:nth-child("+t+")",r);return n};var U=function(){if(!p){p=true;if(s.settings.autoplay){clearInterval(h)}L.removeClass("pause").text("Play").attr("title","Play");s.settings.onClickPause.apply(r,[l,c,arguments])}else{p=false;j();F();L.addClass("pause").text("Pause").attr("title","Pause");s.settings.onClickPlay.apply(r,[l,c,arguments])}};var z=function(){if(p){j();p=false;L.addClass("pause")}};var W=function(){if(s.settings.autoplay){clearInterval(h)}};var X=function(){if(!p){j()}};var V=function(){var t=o.eq(l),n,i;if(s.settings.navType=="list"){d=!(l>c||l==0&&c==u-1||l==c&&l==0)}s.settings.onSlideChange.apply(r,[l,c,d,arguments]);if(s.settings.resize){N.animate({paddingTop:1/t.data("aspectRatio")*100+"%"},{duration:s.settings.speed,easing:s.settings.easing})}else if(t.data("aspectRatio")){i=Math.floor(r.width()/r.height()*1e3)/1e3;n=Math.floor(t.data("aspectRatio")*1e3)/1e3;t.removeClass("billboard-portrait billboard-landscape").addClass(i>n?"billboard-portrait":"billboard-landscape")}o.each(function(t){if(t==l&&s.settings.includeFooter){b=e(this).attr("title");e(".billboard-caption",r).fadeOut(s.settings.speed*.5,function(){if(b){e(this).text(b).fadeIn(s.settings.speed*.5)}})}switch(s.settings.transition){case"fade":if(t==l){e(this).animate({opacity:"show"},{duration:s.settings.speed})}else{e(this).animate({opacity:"hide"},{duration:s.settings.speed})}break;case"left":case"right":if(t==l||t==c){v=t==l?100*(d?-1:1):0;m=t==l?0:-100*(d?-1:1);if(s.settings.transition=="right"){v*=-1;m*=-1}e(this).css("left",v+"%").css("z-index",t==l?u+100:1).animate({left:m+"%"},{duration:s.settings.speed,easing:s.settings.easing,queue:false}).show()}else{e(this).hide()}break;case"up":case"down":if(t==l||t==c){g=t==l?100*(d?-1:1):0;y=t==l?0:-100*(d?-1:1);if(s.settings.transition=="down"){g*=-1;y*=-1}e(this).css("top",g+"%").css("z-index",t==l?u+100:1).animate({top:y+"%"},{duration:s.settings.speed,easing:s.settings.easing,queue:false}).show()}else{e(this).hide()}break}if(s.settings.includeFooter){if(t==l){e("a[rel="+t+"]",x).addClass("active")}else{e("a[rel="+t+"]",x).removeClass("active")}}});j()};A()}})(jQuery)